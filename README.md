---
title: "主成分分析による次元削減の実例"
author: "ryohei"
date: "2023-09-07"
output: html_document
---

# イントロダクション

## 目的

高次元データの変数間に何らかの関係性があるとき、主成分分析による次元削減が有効であることを示す。

## 背景

点の配置が与えられたデータから決定論によって一位に定まる場合でも、それをデータから計算することはコストが大きい場合がある。このような場合に低コストで効率よく点の位置を概算する方法を論じたい。

## 対象データとその制限

対象となるのは以下のデータである。点A, B, ..., E は半径2の円周上にあり、 16個の各個体は半径１の円周上にある。各変数は個体と各点との距離である。幾何学的考察から、個体は2つの変数のみで定まることがわかるので、データの次元は2に削減できることが予想される。

```{r okamoto}
print(okamoto[1:3,])
```

# データの前処理

## データの収集方法

データは教材の表から手打ちで`oka.csv`を作成した。

## データのクリーニング

カラムにA-Eをラベル付けし、matrix型の`okamoto`として保存した。

# 探索的データ解析

基本的なプロファイルは以下のようになる。

```{r okamoto}
summary(okamoto)
```

## 特徴量エンジニアリング

主成分分析を行うと、以下のようになる。第1,2主成分の累積寄与率が99.9%を超えている。

```{r oka.pca}
summary(oka.pca)

```

また、各主成分は以下の通り。

```{r}
print(oka.pca$loadings)
```

第1、2主成分のプロット。

```{r oka.pca okamoto}
plot(oka.pca$loadings[,1:2], type="n")
text(oka.pca$loadings, colnames(okamoto))
```

個体の情報はほぼすべて以下の第1,2主成分得点に含まれていることがわかる。さらに図から、この2次元表現がデータの円構造を反映していることが見て取れる。

```{r oka.pca}
round(oka.pca$scores, 2)
plot(oka.pca$scores[,1], oka.pca$scores[,2], type="n")
text(oka.pca$scores[,1], oka.pca$scores[,2], 1:16)
```

# モデル構築

主成分分析を用いたデータから特徴量のシンプルな予測を行ってみる。

```{r okamoto oka.pca}
# 予測
oka.pc1 <- princomp(okamoto[1:10,])
oka.pre <- predict(oka.pc1, okamoto[11:16,])

# 既存のプロット設定
plot(oka.pc1$scores[,1], oka.pc1$scores[,2], xlim=range(c(oka.pc1$scores[,1], oka.pre[,1])), ylim=range(c(oka.pc1$scores[,2], oka.pre[,2])), type="n")
text(oka.pc1$scores[,1], oka.pc1$scores[,2], 1:10)

# 新しいプロットを追加
points(oka.pre[,1], oka.pre[,2], col="blue")  # 点を青色で追加
text(oka.pre[,1], oka.pre[,2], 11:16, col="red")  # ラベルを赤色で追加
```

# 結果

幾何学的特性が背後にあるデータに対して、主成分分析による次元削減が確認できた。

# 考察

主成分分析によってデータの次元が5次元から半分以下の2次元に削減された。さらに、ただ次元が削減されただけでなく、射影後の2次元データは楕円状に分布し、元のデータの背後の幾何学的特性を反映していた。

# 結論

主成分分析は変数間の関係を持つ高次元データの次元削減に非常に有効である。さらに、本質的な要素（主成分）に次元を削減することで、見えなかったデータの構造が浮かびあがる場合がある。

ただし、テーブルデータ以外のテキストや画像といった非線形性の強い高次元データにこの手法を適用するには工夫が必要と思われる。

# 参考文献

金明哲、Rによるデータサイエンス、2007
